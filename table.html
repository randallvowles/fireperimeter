<!DOCTYPE html>
<meta charset="utf-8">
<html>

<head>
    <link href='assets/fonts/font-awesome-4.7.0/css/font-awesome.min.css' rel="stylesheet">
    <link href='assets/css/main.css' rel="stylesheet">
    <script src="assets/js/core/baseplate.js"></script>
    <style>
        td,
        th {
            padding: 1px 4px;
            border: 1px solid black;
        }
        
        table {
            border-collapse: collapse;
            border: 1px solid black;
        }
        
        .bang {
            background: red;
            font-weight: bold;
        }
        
        .boom {
            background: yellow;
            font-weight: bold;
        }
        
        .qcbang {
            /*color: #000;*/
            background: repeating-linear-gradient(-45deg, red, red 30px, yellow 30px, yellow 60px);
            font-weight: bold;
        }
        
        .hide {
            display: none;
        }
    </style>
</head>

<body>
    <form>
        <div id="input_form.php">
            <label>Air Temperature - </label>
            <label>Min: <input type="text" id="minValueAT" value="null"></label>
            <label>Max: <input type="text" id="maxValueAT" value="null"></label></br>
            <label>Relative Humidity - </label>
            <label>Min: <input type="text" id="minValueRH" value="null"></label>
            <label>Max: <input type="text" id="maxValueRH" value="null"></label></br>
            <label>Wind Speed - </label>
            <label>Min: <input type="text" id="minValueWS" value="null"></label>
            <label>Max: <input type="text" id="maxValueWS" value="null"></label></br>
            <label>Wind Direction - </label>
            <label>Min: <input type="text" id="minValueWD" value="null"></label>
            <label>Max: <input type="text" id="maxValueWD" value="null"></label></br>
            <input type="button" value="Apply" id="applyRule" onclick=_applyRule()>
            <label>Exclude stations that do not meet any of the selected parameters? <input type="checkbox" onclick="_exclusions(this);"></label></br>
        </div>
        <div id="nettable-container"></div>
        <script type="text/javascript">
            _exclusions = function (checkbox) {
                    d3.selectAll("tr").selectAll("td").each(function (d) {
                            d3.select(this.parentNode).classed('hide', function(d){
                                if (d3.select(this).classed("bang") !== true){
                                    return checkbox.checked;
                                } else {
                                    return !checkbox.checked;
                            }
                        })
                    })
                    // d3.selectAll("tr").each(function (d) {
                    //         if (d3.select(this) === "bang") {
                    //             return;
                    //         } else {
                    //             console.log("here")
                    //             d3.select(this.parentNode).classed("hide", function () {
                    //                 return checkbox.checked;
                    //             })
                    //         }
                    //     })
                        // d3.select(this.parentNode).classed('boom', true)})
                        // d3.selectAll("tr")
                        // d3.selectAll("tr").classed("hide", function () {
                        //     if (d3.select(this).selectAll("td") === "bang") {
                        //         return false;
                        //     } else {
                        //         // return checkbox.checked
                        //         d3.select(this.parentNode).classed("hide", function () {
                        //                 return checkbox.checked;
                        //             })
                        // d3.selectAll("td").classed("hide", function () {
                        // console.log(d3.select(this).selectAll("td").classed("bang"))
                        // if (d3.select(this.parentNode).selectAll("bang") !== true) {
                        // if (d3.selectAll("tr").select("td").classed("bang") !== true || d3.selectAll("tr").select("td").classed("qcbang") !== true) {
                        // return checkbox.checked
                        // } else {
                        // return false;
                }
                //     })
                // }
            _applyRule = function () {
                var minValueAT = document.getElementById('minValueAT').value;
                var maxValueAT = document.getElementById('maxValueAT').value;
                var minValueRH = document.getElementById('minValueRH').value;
                var maxValueRH = document.getElementById('maxValueRH').value;
                var minValueWS = document.getElementById('minValueWS').value;
                var maxValueWS = document.getElementById('maxValueWS').value;
                var minValueWD = document.getElementById('minValueWD').value;
                var maxValueWD = document.getElementById('maxValueWD').value;
                var current_url = window.location.href
                var base_url = current_url.replace(/(select=)\S+(\}\})/, "");
                var new_url = (base_url + "?select={\"air_temp\":{\"min\":" + minValueAT +
                    ",\"max\":" + maxValueAT + "},\"relative_humidity\":{\"min\":" +
                    minValueRH + ",\"max\":" + maxValueRH + "},\"wind_speed\":{\"min\":" +
                    minValueWS + ",\"max\":" + maxValueWS + "},\"wind_direction\":{\"min\":" +
                    minValueWD +
                    ",\"max\":" + maxValueWD + "}}");
                window.location.href = new_url;
                // var filterInterface = {
                //     ".air_temp": {
                //         "min": minValueAT,
                //         "max": maxValueAT
                //     },
                //     ".relative_humidity": {
                //         "min": minValueRH,
                //         "max": maxValueRH
                //     },
                //     ".wind_speed": {
                //         "min": minValueWS,
                //         "max": maxValueWS
                //     },
                //     ".wind_direction": {
                //         "min": minValueWD,
                //         "max": maxValueWD
                //     }
                // };
                // var newURL = base_url + "?select=" + JSON.stringify(filterInterface);
            };
            // _excludeNonHighlightedCells = function (){
            //     if (document.getElementById("exclusions").checked) {
            //         // If clicked, hide all NOT "bang"
            //         d3.selectAll("bang")
            //     } else {
            //         // If not clicked, show all stid's
            //     }
            // }
        </script>
</body>
<!--<script src="assets/js/core/mesonet-current.min.js"></script>-->
<script src="http://dev2.mesowest.net/tomato//assets/js/core/mesonet-current.js"></script>
<script src="assets/js/core/sample_fire.js"></script>
<script src="http://dev2.mesowest.net/tomato//assets/js/core/d3.v4.js"></script>
<!--<script src="assets/js/core/d3.v4.min.js"></script>-->
<script src="assets/js/apps/app-fireperimeter.js"></script>
<script src="http://dev2.mesowest.net/tomato//assets/js/core/units.js"></script>

</html>